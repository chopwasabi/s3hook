// s3.js - v0.1.0 - https://github.com/jpillora/aws-sdk-browser
// Jaime Pillora <dev@jpillora.com> - MIT Copyright 2013
!function(a,b){var c={hex:"0123456789abcdef",utf8:"\0",utf8_table:{},ascii:"\0\b	\n\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~ ¡¢£¤¥¦§¨©ª«¬­®¯°±²³´µ¶·¸¹º»¼½¾¿ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖ×ØÙÚÛÜÝÞßàáâãäåæçèéêëìíîïðñòóôõö÷øùúûüýþÿ",ascii_table:{0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,"\0":0,"":1,"":2,"":3,"":4,"":5,"":6,"":7,"\b":8,"	":9,"\n":10,"":11,"\f":12,"\r":13,"":14,"":15,"":16,"":17,"":18,"":19,"":20,"":21,"":22,"":23,"":24,"":25,"":26,"":27,"":28,"":29,"":30,"":31," ":32,"!":33,'"':34,"#":35,$:36,"%":37,"&":38,"'":39,"(":40,")":41,"*":42,"+":43,",":44,"-":45,".":46,"/":47,":":58,";":59,"<":60,"=":61,">":62,"?":63,"@":64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,"[":91,"\\":92,"]":93,"^":94,_:95,"`":96,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,"{":123,"|":124,"}":125,"~":126,"":127,"":128,"":129,"":130,"":131,"":132,"":133,"":134,"":135,"":136,"":137,"":138,"":139,"":140,"":141,"":142,"":143,"":144,"":145,"":146,"":147,"":148,"":149,"":150,"":151,"":152,"":153,"":154,"":155,"":156,"":157,"":158,"":159," ":160,"¡":161,"¢":162,"£":163,"¤":164,"¥":165,"¦":166,"§":167,"¨":168,"©":169,"ª":170,"«":171,"¬":172,"­":173,"®":174,"¯":175,"°":176,"±":177,"²":178,"³":179,"´":180,"µ":181,"¶":182,"·":183,"¸":184,"¹":185,"º":186,"»":187,"¼":188,"½":189,"¾":190,"¿":191,"À":192,"Á":193,"Â":194,"Ã":195,"Ä":196,"Å":197,"Æ":198,"Ç":199,"È":200,"É":201,"Ê":202,"Ë":203,"Ì":204,"Í":205,"Î":206,"Ï":207,"Ð":208,"Ñ":209,"Ò":210,"Ó":211,"Ô":212,"Õ":213,"Ö":214,"×":215,"Ø":216,"Ù":217,"Ú":218,"Û":219,"Ü":220,"Ý":221,"Þ":222,"ß":223,"à":224,"á":225,"â":226,"ã":227,"ä":228,"å":229,"æ":230,"ç":231,"è":232,"é":233,"ê":234,"ë":235,"ì":236,"í":237,"î":238,"ï":239,"ð":240,"ñ":241,"ò":242,"ó":243,"ô":244,"õ":245,"ö":246,"÷":247,"ø":248,"ù":249,"ú":250,"û":251,"ü":252,"ý":253,"þ":254,"ÿ":255},base64:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",_searchCharTable:function(a,b){for(var a=a+"",b=b+"",c=0,d=b.length,e=0,f="";e!=(e=c+d>>1);){if(f=(e>>>=0)<b.length?b[e]:"",a==f)return e;a>f?c=e:d=e}return 0},b2h:function(a){var b=this.hex+"",c=15&a>>4,d=15&a;return((c>>>=0)<b.length?b[c]:"0")+((d>>>=0)<b.length?b[d]:"0")},b64c:function(a){return"+"==a||"-"==a?62:"/"==a||"_"==a?63:a>="0"&&"9">=a?+a+52:this._searchCharTable(a,this.base64)},charCode:function(a){var b=this.ascii_table;return 1==a.length&&"ÿ">=a?b[a]:this._searchCharTable(a,this.utf8)},a2b:function(a){var b=this.ascii_table;return 1==a.length&&"ÿ">=a?b[a]:0},b2a:function(a){var b=this.ascii+"";return(a>>>=0)<b.length?b[a]:"\0"},fromCharCode:function(a){var b=this.ascii+"",c=this.utf8+"";return(a>>>=0)<b.length?b[a]:(a>>>=0)<c.length?c[a]:"\0"},astr2hstr:function(a){var b="",c=0,a=a+"";for(c=0;c<a.length;c++)b+=this.b2h(this.a2b(a[c]));return b},hstr2astr:function(a){var b=0,c=0,d="",e="",f=this.ascii+"",a=a+"";for(b=0;b<a.length;b++)1&b?(c=+("0x"+d+a[b]),e+=(c>>>=0)<f.length?f[c]:"\0"):d=a[b];return e},utf8_encode:function(a){var b="",c=0,d=0,e="",f=[0,0,0,0],g=[0,0];for(c=0;c<a.length;c++){if(d=this.a2b(e=a[c]),0!=g[0]){if(128>d||d>191){g=[0,0];continue}if(f[3&g[1]+1-g[0]--]=d,g[0])continue;b+=this.fromCharCode(1==g[1]?(31&f[0])<<6|63&f[1]:(15&f[0])<<12|(63&f[1])<<6|63&f[2])}f[0]=d,128>d?b+=e:d>191&&224>d?g=[1,1]:d>=224&&240>d&&(g=[2,2])}return b},utf8_decode:function(a){var b="",c=0,d=0,a=a+"",e=this.b2a(0);for(c=0;c<a.length;c++)d=this.charCode(e=a[c]),b+=128>d?e:2048>d?this.b2a(192|d>>6)+this.b2a(128|63&d):this.b2a(224|d>>12)+this.b2a(128|63&d>>6)+this.b2a(128|63&d);return b},base64_encode:function(a){return this._base64_encode(a,!1)},base64_urlencode:function(a){return this._base64_encode(a,!0)},_base64_encode:function(a,b){var c="",d=0,e=0,a=a+"",f=[0,0],g=b?"":"=",h=this.base64+"0123456789"+(b?"-_":"+/"),i=function(a){return(a>>>=0)<h.length?h[a]:"A"};for(d=0;d<a.length;d++)e=this.a2b(a[d]),2==d%3?(e+=(f[1]<<8)+(f[0]<<16),c+=i(63&e>>>18),c+=i(63&e>>>12),c+=i(63&e>>>6),c+=i(63&e),f=[0,0]):f[1&d%3]=e;return 0!=d%3&&(e=(f[1]<<8)+(f[0]<<16),c+=i(63&e>>>18),c+=i(63&e>>>12),c+=2==d%3?i(63&e>>>6):g,c+=g),c},base64_decode:function(a){var a=a+"",b="",c=[0,0,0,0],d=0,e="",f=0;for(0!=(3&a.length)&&(a+="="),d=0;d<a.length&&"="!=(e=a[d]);d++)f=this.b64c(e),3==(3&d)?(f+=(c[2]<<6)+(c[1]<<12)+(c[0]<<18),b+=this.b2a(255&f>>>16),b+=this.b2a(255&f>>>8),b+=this.b2a(255&f),c=[0,0,0,0]):c[3&d%4]=f;return(3&d)>1&&(f=(c[2]<<6)+(c[1]<<12)+(c[0]<<18),b+=this.b2a(255&f>>>16),3==(3&d)&&(b+=this.b2a(255&f>>>8))),b}},d=function(){var a={name:"sha1",identifier:"2b0e03021a",size:20,block:64,hash:function(a){for(var b=(a+="").length,d=b>>6,e=63&b,f="",g=0,h=0,i=[1732584193,4023233417,2562383102,271733878,3285377520],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];56!=e++;)a+="\0",64==e&&(d++,e=0);for(a+="\0\0\0\0",e=3,b=8*(b-1);e>=0;e--)a+=c.b2a(255&b>>8*e);for(g=0;g<a.length;g++)h=(h<<8)+c.a2b(a[g]),3==(3&g)&&(j[15&g>>2]=h,h=0),63==(63&g)&&this._round(i,j);for(g=0;g<i.length;g++)for(h=3;h>=0;h--)f+=c.b2a(255&i[g]>>8*h);return f},_round:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=0,i=[1518500249,1859775393,2400959708,3395469782],j=function(a,b){return b<<a|b>>>32-a},k=0,l=function(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d};for(h=0;80>h;h++)h>=16&&(b[127&h]=j(1,b[127&h-3]^b[127&h-8]^b[127&h-14]^b[127&h-16])),k=0|j(5,c)+l(h,d,e,f)+g+b[127&h]+i[3&h/20],g=f,f=e,e=j(30,d),d=c,c=k;a[0]=0|a[0]+c,a[1]=0|a[1]+d,a[2]=0|a[2]+e,a[3]=0|a[3]+f,a[4]=0|a[4]+g}},b={name:"sha-256",identifier:"608648016503040201",size:32,block:64,key:[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],hash:function(a){for(var a=a+"",b=a.length,d=b>>6,e=63&b,f="",g=0,h=0,i=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];56!=e++;)a+="\0",64==e&&(d++,e=0);for(a+="\0\0\0\0",e=3,b=8*(b-1);e>=0;e--)a+=c.b2a(255&b>>8*e);for(g=0;g<a.length;g++)h=(h<<8)+c.a2b(a[g]),3==(3&g)&&(j[15&g>>2]=h,h=0),63==(63&g)&&this._round(i,j);for(g=0;g<i.length;g++)for(h=3;h>=0;h--)f+=c.b2a(255&i[g]>>8*h);return f},_round:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=0,l=0,m=0,n=0;for(k=0;64>k;k++)16>k?n=b[15&k]:(l=b[15&k+1],m=b[15&k+14],n=b[15&k]=0|(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+b[15&k]+b[15&k+9]),n=n+j+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(i^g&(h^i))+this.key[63&k],j=i,i=h,h=g,g=0|f+n,f=e,e=d,d=c,c=0|n+(d&e^f&(d^e))+(d>>>2^d>>>13^d>>>22^d<<30^d<<19^d<<10);a[0]=0|a[0]+c,a[1]=0|a[1]+d,a[2]=0|a[2]+e,a[3]=0|a[3]+f,a[4]=0|a[4]+g,a[5]=0|a[5]+h,a[6]=0|a[6]+i,a[7]=0|a[7]+j}};return{sha256:b,sha1:a,SHA256:function(a){return c.astr2hstr(this.sha256.hash(a))},SHA1:function(a){return c.astr2hstr(this.sha1.hash(a))},hmac_hash:b,HMAC:function(a,b){var a=a+"",b=b+"",d=0,e=this.hmac_hash,f=0,g="",h="";for(a.length>e.block&&(a=e.hash(a));a.length<e.block;)a+="\0";for(d=0;d<a.length;d++)f=c.a2b(a[d]),g+=c.b2a(54^f),h+=c.b2a(92^f);return c.astr2hstr(e.hash(h+e.hash(g+b)))}}}();!function(a,b){!function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=[].slice;e=["open","setRequestHeader","send","abort","getAllResponseHeaders","getResponseHeader","overrideMimeType"],d=["onreadystatechange","onprogress","onloadstart","onloadend","onload","onerror","onabort"],f=["readyState","responseText","withCredentials","statusText","status","response","responseType","responseXML","upload"],g=f[0],h=f[1],i=f[2],k=function(a){var b;return b=function(){},b.prototype=a,new b},o=[],n=function(a,b){return null==b&&(b=o.length),o.splice(b,0,a)},j=function(a,b){var c,d,e,f,g,h;switch(null==b&&(b={}),typeof a){case"object":d=[];for(e in a)f=a[e],d.push(""+e+":	"+f);return d.join("\n");case"string":for(d=a.split("\n"),g=0,h=d.length;h>g;g++)c=d[g],/([^:]+):\s*(.+)/.test(c)&&(b[RegExp.$1]||(b[RegExp.$1]=RegExp.$2));return b}},n.headers=j,n.PROPS=f,l=function(b){var c;return(c=a[b])?a[b]=function(a){return"string"!=typeof a||/\.XMLHTTP/.test(a)?m(new c(a),c):void 0}:void 0},l("ActiveXObject"),l("XMLHttpRequest"),m=function(b){var h,l,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;if(0===o.length)return b;for(r=!1,D={},C={},C[i]=!1,s={},t={},m={},l=function(a){var c,d,e;c={};for(d in a)e=a[d],c[d]=e===b?C:e;return c},w=k(m),B={},w.set=function(a,c){var d;if(r=!0,B[a]=1,a===g){for(d=[];C[g]<c;)C[g]++,C[g]!==b[g]&&(w.trigger("readystatechange"),1===C[g]&&w.trigger("loadstart"),4===C[g]?(w.trigger("load"),d.push(w.trigger("loadend"))):d.push(void 0));return d}return C[a]=c},z=k(s),w.setRequestHeader=function(a,c){return r=!0,z[a]=c,m.opened?b.setRequestHeader(a,c):void 0},A=k(t),w.setResponseHeader=function(a,b){return r=!0,A[a]=b},y={},x={},w.onChange=function(a,b){return r=!0,(y[a]=y[a]||[]).push(b)},w.onCall=function(a,b){return r=!0,(x[a]=x[a]||[]).push(b)},w.trigger=function(a,b){var c;return null==b&&(b={}),a=a.replace(/^on/,""),b.type=a,null!=(c=C["on"+a])?c.call(C,b):void 0},w.serialize=function(){var a,b,c,d,e,g,h,i;for(c={},h=0,i=f.length;i>h;h++)b=f[h],c[b]=C[b];e={};for(a in A)g=A[a],e[a]=g;d={};for(a in z)g=z[a],d[a]=g;return{method:m.method,url:m.url,async:m.async,body:m.body,responseHeaders:e,requestHeaders:d,props:c}},w.deserialize=function(a){var b,c,d,e,f,g,h,i,j,k;for(h=["method","url","async","body"],f=0,g=h.length;g>f;f++)c=h[f],a[c]&&(w[c]=a[c]);i=a.responseHeaders||{};for(b in i)e=i[b],w.setResponseHeader(b,e);j=a.requestHeaders||{};for(b in j)e=j[b],w.setRequestHeader(b,e);k=a.props||{};for(d in k)e=k[d],w.set(d,e)},F=0,I=e.length;I>F;F++)q=e[F],b[q]&&function(a){return C[a]=function(){var d,e,f,g,h,i,k;switch(d=1<=arguments.length?p.call(arguments,0):[],m.opened=!m.opened&&"open"===a,m.sent=!m.sent&&"send"===a,a){case"getAllResponseHeaders":return j(A);case"send":m.body=d[0];break;case"open":m.method=d[0],m.url=d[1],m.async=d[2]}for(g=d,f=x[a]||[],i=0,k=f.length;k>i;i++){if(e=f[i],h=e(d),h===!1)return;h&&(g=h)}return"setRequestHeader"!==a||(s[g[0]]=g[1],z[d[0]]===c)?b[a]?b[a].apply(b,g):void 0:void 0}}(q);for(u=function(){var a,c,d,e,g;try{for(g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(v(c,b[c]));return g}catch(h){if(a=h,"TypeError"===a.constructor.name)throw a}},v=function(a,d){var e,f,h,i,k,l,n,o,p;if(k=D[a],d!==k){if(D[a]=d,a===g){if(1===d)for(h in z)n=z[h],b.setRequestHeader(h,n);2===d&&(m.statusCode=b.status,j(b.getAllResponseHeaders(),t))}for(f=y[a]||[],o=0,p=f.length;p>o;o++)e=f[o],l=e(d,k),l!==c&&(i=l);if(!B[a])return C[a]=i===c?d:i}},E=function(c){return b[c]=function(b){var d;return u(),b&&(d=l(b)),(a.E=a.E||[]).push(d),C[c]?C[c].call(C,d):void 0}},G=0,J=d.length;J>G;G++)n=d[G],E(n);for(u(),H=0,K=o.length;K>H;H++)h=o[H],h.call(null,w);return r?C:b},a.xhook=n}(a,b);var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;for(e=location.protocol+"//"+location.host,s=function(a){return a="xdomain ("+e+"): "+a,console.warn?console.warn(a):alert(a)},x=["postMessage","JSON"],t=0,v=x.length;v>t;t++)if(f=x[t],!a[f])return s("requires '"+f+"' and this browser does not support it"),void 0;for(d="XPING",h=function(){return(Math.random()*Math.pow(2,32)).toString(16)},l=function(a){return/(https?:\/\/[^\/]+)(\/.*)?/.test(a)?{origin:RegExp.$1,path:RegExp.$2}:null},r=function(a){var b;return a instanceof RegExp?a:(b=a.toString().replace(/\W/g,function(a){return"\\"+a}).replace(/\\\*/g,".+"),new RegExp("^"+b+"$"))},j=function(c){return b.addEventListener?a.addEventListener("message",c):a.attachEvent("onmessage",c)},n=function(a){return JSON.stringify(a)},g=function(a){return JSON.parse(a)},p=function(b){return j(function(a){var c,d,e,f,h,i,j,k,m,o,p,q,t;i=a.origin,k=null;for(e in b){o=b[e];try{if(f=r(e),f.test(i)){k=r(o);break}}catch(u){}}if(!k)return s("blocked request from: '"+i+"'"),void 0;if(c=a.source,h=g(a.data),p=h.req,j=l(p.url),!j||!k.test(j.path))return s("blocked request to path: '"+j.path+"' by regex: "+o),void 0;m=new XMLHttpRequest,m.open(p.method,p.url),m.onreadystatechange=function(){var a,b,d,e;if(4===m.readyState){for(b={props:{}},e=xhook.PROPS,d=e.length-1;d>=0;d+=-1)j=e[d],"responseXML"!==j&&(b.props[j]=m[j]);return b.responseHeaders=xhook.headers(m.getAllResponseHeaders()),a=n({id:h.id,res:b}),c.postMessage(a,i)}},t=p.requestHeaders;for(d in t)q=t[d],m.setRequestHeader(d,q);return m.send(p.body||null)}),a===a.parent?s("slaves must be in an iframe"):a.parent.postMessage(d,"*")},o=function(a){return j(function(a){var b;return null!=(b=c.prototype.frames[a.origin])?b.recieve(a):void 0}),xhook(function(b){return b.onCall("open",function(c){var d;return d=l(c[1]),d&&a[d.origin]?(c[2]===!1&&s("sync not supported"),setTimeout(function(){return b.set("readyState",1)}),!1):void 0}),b.onCall("send",function(){var d,e;return e=l(b.url),e&&a[e.origin]?(d=new c(e.origin,a[e.origin]),d.send(b.serialize(),function(a){return b.deserialize(a)}),!1):void 0})})},c=function(){function a(a,c){return this.origin=a,this.proxyPath=c,this.frames[this.origin]?this.frames[this.origin]:(this.frames[this.origin]=this,this.listeners={},this.frame=b.createElement("iframe"),this.frame.id=this.frame.name="xdomain-"+h(),this.frame.src=this.origin+this.proxyPath,this.frame.setAttribute("style","display:none;"),b.body.appendChild(this.frame),this.waits=0,this.ready=!1,void 0)}return a.prototype.frames={},a.prototype.post=function(a){return this.frame.contentWindow.postMessage(a,this.origin)},a.prototype.listen=function(a,b){if(this.listeners[a])throw"already listening for: "+a;return this.listeners[a]=b},a.prototype.unlisten=function(a){return delete this.listeners[a]},a.prototype.recieve=function(a){var b,c;return a.data===d?(this.ready=!0,void 0):(c=g(a.data),(b=this.listeners[c.id])?(this.unlisten(c.id),b(c.res)):(s("unkown message ("+c.id+")"),void 0))},a.prototype.send=function(a,b){var c=this;return this.readyCheck(function(){var d;return d=h(),c.listen(d,function(a){return b(a)}),c.post(n({id:d,req:a}))})},a.prototype.readyCheck=function(a){var b=this;if(this.ready===!0)return a();if(this.waits++>=100)throw"Timeout connecting to iframe: "+this.origin;return setTimeout(function(){return b.readyCheck(a)},100)},a}(),a.xdomain=function(a){return a?(a.masters&&p(a.masters),a.slaves?o(a.slaves):void 0):void 0},xdomain.origin=e,y=b.getElementsByTagName("script"),u=0,w=y.length;w>u;u++)if(m=y[u],/xdomain/.test(m.src)){if(m.hasAttribute("slave")){if(k=l(m.getAttribute("slave")),!k)return;q={},q[k.origin]=k.path,xdomain({slaves:q})}m.hasAttribute("master")&&(i={},i[m.getAttribute("master")]=/./,xdomain({masters:i}))}}(a,b);var e,f,g,h,i,j,k,l;e="accessKeyId",f="secretAccessKey",l={"https://s3.amazonaws.com":"/jpillora-usa/proxy.html","https://s3-ap-southeast-2.amazonaws.com":"/jpillora-aus/proxy.html"},xdomain({slaves:l}),j=[];for(i in l)j.push(i);h={},d.hmac_hash=d.sha1,k=function(a,b){return c.base64_encode(c.hstr2astr(d.HMAC(a,b)))},g=function(a,b){var c,d,g,i,j,l,m,n,o,p,q,r,s,t,u;if(null==b&&(b=function(){}),!h[e])throw"NO AWS ACCESS SET";if(!h[f])throw"NO AWS SECRET SET";d="AWS "+h[e]+":",n=a.method||"GET",r=a.url||"",o=r.replace(/https?\:\/\/[^\/]+/,""),"GET"!==n&&(q="text/plain; charset=UTF-8"),a.type&&(q=a.type),i=(new Date).toUTCString(),g=a.body,t=new XMLHttpRequest,t.open(n,r),c=[],l={},p=function(a,b){return t.setRequestHeader(a,b),/^x-amz/i.test(a)&&c.push(a.toLowerCase()+":"+b),l[a]=b},q&&p("Content-Type",q),p("x-amz-date",i),u=a.headers;for(j in u)s=u[j],p(j,s);return m=[n,"",q,"",c.join("\n"),o].join("\n"),p("Authorization",d+k(h[f],m)),t.onreadystatechange=function(){return 4===t.readyState?b({status:t.status,requestHeaders:l,responseHeaders:xhook.headers(t.getAllResponseHeaders()),responseText:t.responseText}):void 0},t.send(g)},a.S3={endpoints:j,set:function(a){var b,c,d;d=[];for(b in a)c=a[b],d.push(h[b]=c);return d},getObject:function(a,b){return g({method:"GET",url:a},b)},putObject:function(a,b,c){return g({method:"PUT",url:a,body:b},c)}}}(window,document);